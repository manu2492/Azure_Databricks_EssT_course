{"version":"NotebookV1","origId":777080948395434,"name":"Quickstart Notebook (3)","language":"sql","commands":[{"version":"CommandV1","origId":777080948395435,"guid":"ce790b90-efe5-4e93-9c93-26d006677fd9","subtype":"command","commandType":"auto","position":0.25,"command":"%md\n# Databricks Quick Start","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863177967,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a627be25-9fcd-4b57-84d1-c9f11a155876"},{"version":"CommandV1","origId":777080948395436,"guid":"27eb747d-3282-4b65-a553-3ab54c4d89bf","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n## Create and use a cluster\n\n1. In the sidebar, right-click the **Clusters** button and open the link in a new window.\n1. On the Clusters page, click **Create Cluster**.\n1. Name the cluster **demo-default**.\n1. In the Databricks Runtime Version drop-down, select **4.3 (includes Apache Spark 2.3.1, Scala 11)**.\n1. Click **Create Cluster**.\n1. Return to this notebook. \n1. In the notebook menu bar, select **<img src=\"http://docs.databricks.com/_static/images/notebooks/detached.png\"/></a> > demo-default**.\n1. When the cluster changes from <img src=\"http://docs.databricks.com/_static/images/clusters/cluster-starting.png\"/></a> to <img src=\"http://docs.databricks.com/_static/images/clusters/cluster-running.png\"/></a>, then you can run the commands in this notebook on your cluster.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178092,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c1e4f402-5679-4b9e-aa93-8e60f95ef1df"},{"version":"CommandV1","origId":777080948395438,"guid":"7b092768-bced-4ed2-b54f-3e0b7cc0a5f2","subtype":"command","commandType":"auto","position":0.75,"command":"%md \n## Create a table from a Databricks dataset","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178103,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e7b3ea04-837f-44d5-8afd-7f221e55746a"},{"version":"CommandV1","origId":777080948395439,"guid":"0874da0e-e5f9-4e8e-80b6-68fa22c6a850","subtype":"command","commandType":"auto","position":1.0,"command":"DROP TABLE IF EXISTS diamonds;\n\nCREATE TABLE diamonds\n  USING csv\n  OPTIONS (path \"/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv\", header \"true\")","commandVersion":0,"state":"finished","results":{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1543863181008,"submitTime":1543863178227,"finishTime":1543863183188,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"5c19de06-7189-4671-bb11-b8be5ff822e9"},{"version":"CommandV1","origId":777080948395440,"guid":"79cfdf89-de3c-4b67-8fd1-174ed55a0890","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n## Manipulate the data and display the results \n\n1. Selects color and price columns, averages the price, and groups and orders by color.\n1. Displays a table of the results.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178230,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"844743aa-f3fd-4212-b694-9f6c1f1732d1"},{"version":"CommandV1","origId":777080948395441,"guid":"dcc2765e-1364-4aca-9b15-be77a61ad62a","subtype":"command","commandType":"auto","position":2.0,"command":"SELECT color, avg(price) AS price FROM diamonds GROUP BY color ORDER BY color","commandVersion":0,"state":"finished","results":{"type":"table","data":[["D",3169.9540959409596],["E",3076.7524752475247],["F",3724.886396981765],["G",3999.135671271697],["H",4486.669195568401],["I",5091.874953891553],["J",5323.81801994302]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"color","type":"\"string\"","metadata":"{}"},{"name":"price","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1543863183216,"submitTime":1543863178353,"finishTime":1543863185771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"267","xColumns":["color"],"yColumns":["price"],"pivotColumns":[],"pivotAggregation":"avg","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"f0e122ae-22f7-4092-88e4-63d98bb60308"},{"version":"CommandV1","origId":777080948395443,"guid":"d9aed2f2-ef17-417c-bab0-ea2a7f2e0d8f","subtype":"command","commandType":"auto","position":3.5,"command":"%md \n## Repeat using the Python DataFrame API. \nThis is a SQL notebook; by default command statements are passed to a SQL interpreter.  \nTo pass command statements to a Python interpreter, include the `%python` magic command.","commandVersion":16,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178356,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"98414dc9-48bd-46de-b8ff-b6b32e5bb960"},{"version":"CommandV1","origId":777080948395444,"guid":"4424312b-e442-4212-81d3-c120997aa94d","subtype":"command","commandType":"auto","position":3.75,"command":"%md\n## Create a DataFrame from a Databricks dataset","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178367,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8a24c64b-30f6-43a8-b86f-d84f6d2c9be7"},{"version":"CommandV1","origId":777080948395445,"guid":"198b7eec-11c0-4471-b9ee-6e6b8cf833e7","subtype":"command","commandType":"auto","position":4.0,"command":"%python\ndiamonds = spark.read.csv(\"/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv\", header=\"true\", inferSchema=\"true\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"diamonds","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_c0","nullable":true,"type":"integer"},{"metadata":{},"name":"carat","nullable":true,"type":"double"},{"metadata":{},"name":"cut","nullable":true,"type":"string"},{"metadata":{},"name":"color","nullable":true,"type":"string"},{"metadata":{},"name":"clarity","nullable":true,"type":"string"},{"metadata":{},"name":"depth","nullable":true,"type":"double"},{"metadata":{},"name":"table","nullable":true,"type":"double"},{"metadata":{},"name":"price","nullable":true,"type":"integer"},{"metadata":{},"name":"x","nullable":true,"type":"double"},{"metadata":{},"name":"y","nullable":true,"type":"double"},{"metadata":{},"name":"z","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1543863185784,"submitTime":1543863178507,"finishTime":1543863187351,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"45a86ada-078b-4c3d-91e4-572797cb841b"},{"version":"CommandV1","origId":777080948395446,"guid":"663fb306-cf9e-45ec-9f81-7708908f2ebf","subtype":"command","commandType":"auto","position":4.5,"command":"%md\n## Manipulate the data and display the results","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1543863178510,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"de7bfa51-6dbb-4b2e-b4e6-9091b942e4df"},{"version":"CommandV1","origId":777080948395447,"guid":"2a591e06-0697-400c-b1f6-9a27c0e65ef2","subtype":"command","commandType":"auto","position":5.0,"command":"%python\nfrom pyspark.sql.functions import avg\n  \ndisplay(diamonds.select(\"color\",\"price\").groupBy(\"color\").agg(avg(\"price\")))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["F",3724.886396981765],["E",3076.7524752475247],["D",3169.9540959409596],["J",5323.81801994302],["G",3999.135671271697],["I",5091.874953891553],["H",4486.669195568401]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"color","type":"\"string\"","metadata":"{}"},{"name":"avg(price)","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":1543863187356,"submitTime":1543863178630,"finishTime":1543863190074,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"lynnlangit@live.com","latestUserId":4262627191364974,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c92cd1ed-a286-40dd-b103-bb46f47eb12e"}],"dashboards":[],"guid":"86cee0e2-8651-41fb-9112-f0fd49a3d4c0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}